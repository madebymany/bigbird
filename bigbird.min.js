(function(){"use strict";function capitaliseFirstLetter(string){return string.charAt(0).toUpperCase()+string.slice(1)}var BigBird=window.BigBird={};BigBird.VERSION="0.2.1";var $=window.jQuery||window.Zepto||window.ender||window.$,o=$({});$.subscribe=function(){o.on.apply(o,arguments)},$.unsubscribe=function(){o.off.apply(o,arguments)},$.publish=function(){o.trigger.apply(o,arguments)};var merge=function(obj){for(var source,len=arguments.length,i=1;len>i;i++)if(source=arguments[i])for(var key in source)source.hasOwnProperty(key)&&(obj[key]=source[key]);return obj},proxy=function(fn,context){return function(){return fn.apply(context,arguments)}},InitializerDefaults={base:document.body,modules:{}},Initializer=BigBird.Initializer=function(options){this.options=merge(InitializerDefaults,options),this.initialize.apply(this)};merge(Initializer.prototype,{initialize:function(){this.base=$(this.options.base),this.set_module_action("module"),this.set_module_action("action"),this.application=this.options.modules,$(document.body).ready(proxy(this.setup,this))},set_module_action:function(name){var value=this.base.attr("data-"+name);if("string"!=typeof value||""===value)throw name+" was not set";this[name]=value.toLowerCase()},setup:function(){this.execute("common","initialize"),this.execute(this.module,"initialize"),this.execute(this.module,this.action)},rerunAction:function(){return this.execute(this.module,this.action)},execute:function(module,action){return module=this.getModule(module),void 0===module?!1:void 0===module[action]||"function"!=typeof module[action]?!1:(module[action].apply(),void 0)},getModule:function(moduleName){return this.application.hasOwnProperty(moduleName)?this.application[moduleName]:(moduleName=capitaliseFirstLetter(moduleName),this.application.hasOwnProperty(moduleName)?this.application[moduleName]:void 0)}});var Module=BigBird.Module=function(options){this._setOptions(options||{}),this.el&&this.setElement(this.el),this.subscriptions&&this.subscribeToEvents(),this.events&&this.delegateEvents(),this.proxied&&this.proxyFunctions(),this.initialize.apply(this,arguments)};merge(Module.prototype,{merge:merge,proxy:proxy,publish:$.publish,subscribe:$.subscribe,$el:null,initialize:function(){},$:function(selector){return null!==this.$el?this.$el.find(selector):void 0},proxyFunctions:function(){var len=this.proxied.length;for(len;len--;){var methodName=this.proxied[len];"function"==typeof this[methodName]&&(this[methodName]=this.proxy(this[methodName],this))}},subscribeToEvents:function(){for(var key in this.subscriptions){var methodName=this.subscriptions[key];this.subscribe(key,this.proxy(this[methodName],this))}},delegateEvents:function(){if(null!==this.$el)for(var key in this.events){var methodName=this.events[key],method=this.proxy(this[methodName],this),match=key.match(this.eventSplitter),eventName=match[1],selector=match[2];""===selector?this.$el.on(eventName,method):this.$el.delegate(selector,eventName,method)}},eventSplitter:/^(\S+)\s*(.*)$/,activate:function(){this.$el.addClass("active")},deactivate:function(){this.$el.removeClass("active")},setElement:function(element){this.el=element||this.el,this.$el=this.el instanceof $?this.el:$(this.el),this.el=this.$el[0],this.data=this.$el.data()},destroy:function(){if(null!==this.$el)for(var key in this.events){var match=key.match(this.eventSplitter),eventName=match[1],selector=match[2],target=""===selector?this.$el:this.$el.find(selector);target.unbind(eventName)}},_setOptions:function(options){this.options=options;for(var key in this.options)this[key]=this.options[key]}});var extend=function(protoProps,staticProps){var child,parent=this;child=protoProps&&protoProps.hasOwnProperty("constructor")?protoProps.constructor:function(){parent.apply(this,arguments)},merge(child,parent,staticProps);var Surrogate=function(){this.constructor=child};return Surrogate.prototype=parent.prototype,child.prototype=new Surrogate,protoProps&&merge(child.prototype,protoProps),child.__super__=parent.prototype,child};Module.extend=extend,"undefined"!=typeof define&&"function"==typeof define&&define.amd&&define("bigbird",[],function(){return BigBird})})();