// Big Bird
// v0.1.0
// by @cjbell88, @ninjabiscuit & @callumj_
(function(e,t){function a(e){return e.charAt(0).toUpperCase()+e.slice(1)}var n=window.BigBird={},r=e({});e.subscribe=function(){r.on.apply(r,arguments)},e.unsubscribe=function(){r.off.apply(r,arguments)},e.publish=function(){r.trigger.apply(r,arguments)};var i={base:e(document.body),module:"data-module",action:"data-action",modules:{}},s=n.Initializer=function(e){this.options=t.extend({},i,e||{}),this.initialize.apply(this,arguments)};t.extend(s.prototype,{initialize:function(){this.base=this.options.base,this.module=this.base.attr(this.options.module),this.action=this.base.attr(this.options.action),this.application=this.options.modules,this.module&&(this.module=this.module.toLowerCase()),this.action&&(this.action=this.action.toLowerCase()),e(document.body).ready(t.bind(this.setup,this))},setup:function(){this.execute("common","initialize"),this.execute(this.module,"initialize"),this.execute(this.module,this.action)},rerunAction:function(){return this.execute(this.module,this.action)},execute:function(e,n){e=this.getModule(e);if(t.isUndefined(e))return!1;if(t.isUndefined(e[n])||!t.isFunction(e[n]))return!1;e[n].apply()},getModule:function(e){return t.has(this.application,e)?this.application[e]:(e=a(e),t.has(this.application,e)?this.application[e]:undefined)}});var o=n.Controller=function(e){this._setElement(),this._setOptions(e||{}),this.subscriptions&&this.subscribeToEvents(),this.proxied&&this.proxyFunctions(),this.events&&this.delegateEvents(),this.initialize.apply(this,arguments)};t.extend(o.prototype,{$:function(e){return this.$el.find(e)},publish:e.publish,subscribe:e.subscribe,initialize:function(){},subscribeToEvents:function(){for(var e in this.subscriptions){var n=this.subscriptions[e];this.subscribe(e,t.bind(this[n],this))}},proxyFunctions:function(){var e=this.proxied.length;for(e;e--;){var n=this.proxied[e];t.isFunction(this[n])&&(this[n]=t.bind(this[n],this))}},eventSplitter:/^(\S+)\s*(.*)$/,delegateEvents:function(){for(var e in this.events){var n=this.events[e],r=t.bind(this[n],this),i=e.match(this.eventSplitter),s=i[1],o=i[2];o===""?this.$el.bind(s,r):this.$el.delegate(o,s,r)}},_setElement:function(){if(t.isUndefined(this.el))return!1;this.$el=this.el instanceof e?this.el:e(this.el),this.el=this.$el[0],this.data=this.$el.data()},_setOptions:function(e){this.options=e;for(var t in this.options)this[t]=this.options[t]}});var u=function(e,n){var r=this,i;e&&t.has(e,"constructor")?i=e.constructor:i=function(){r.apply(this,arguments)},t.extend(i,r,n);var s=function(){this.constructor=i};return s.prototype=r.prototype,i.prototype=new s,e&&t.extend(i.prototype,e),i.__super__=r.prototype,i};o.extend=u})(jQuery,_);