// Big Bird
// v0.1.0
// by @cjbell88, @ninjabiscuit & @callumj_
(function(e){function f(e){return e.charAt(0).toUpperCase()+e.slice(1)}var t=window.BigBird={},n=e({});e.subscribe=function(){n.on.apply(n,arguments)},e.unsubscribe=function(){n.off.apply(n,arguments)},e.publish=function(){n.trigger.apply(n,arguments)};var r={base:e(document.body),module:"data-module",action:"data-action",modules:{}},i=t.Initializer=function(t){this.options=e.extend({},r,t||{}),this.initialize.apply(this,arguments)};e.extend(i.prototype,{initialize:function(){this.base=this.options.base,this.module=this.base.attr(this.options.module),this.action=this.base.attr(this.options.action),this.application=this.options.modules;if(this.module===undefined||this.action===undefined||this.application===undefined)return!1;this.module&&(this.module=this.module.toLowerCase()),this.action&&(this.action=this.action.toLowerCase()),e(document.body).ready(e.proxy(this.setup,this))},setup:function(){this.execute("common","initialize"),this.execute(this.module,"initialize"),this.execute(this.module,this.action)},rerunAction:function(){return this.execute(this.module,this.action)},execute:function(e,t){e=this.getModule(e);if(e===undefined)return!1;if(e[t]===undefined||typeof e[t]!="function")return!1;e[t].apply()},getModule:function(e){return this.application.hasOwnProperty(e)?this.application[e]:(e=f(e),this.application.hasOwnProperty(e)?this.application[e]:undefined)}});var s={publish:e.publish,subscribe:e.subscribe,initialize:function(){},subscribeToEvents:function(){for(var t in this.subscriptions){var n=this.subscriptions[t];this.subscribe(t,e.proxy(this[n],this))}},eventSplitter:/^(\S+)\s*(.*)$/,_setOptions:function(e){this.options=e;for(var t in this.options)this[t]=this.options[t]}},o=t.Controller=function(e){this._setOptions(e||{}),this.subscriptions&&this.subscribeToEvents(),this.proxied&&this.proxyFunctions(),this.initialize.apply(this,arguments)};e.extend(o.prototype,s,{proxyFunctions:function(){var t=this.proxied.length;for(t;t--;){var n=this.proxied[t];typeof this[n]=="function"&&(this[n]=e.proxy(this[n],this))}}});var u=t.View=function(e){this._setElement(),this._setOptions(e||{}),this.subscriptions&&this.subscribeToEvents(),this.events&&this.delegateEvents(),this.initialize.apply(this,arguments)};e.extend(u.prototype,s,{$:function(e){return this.$el.find(e)},delegateEvents:function(){for(var t in this.events){var n=this.events[t],r=e.proxy(this[n],this),i=t.match(this.eventSplitter),s=i[1],o=i[2];o===""?this.$el.bind(s,r):this.$el.delegate(o,s,r)}},_setElement:function(){if(this.el===undefined)return!1;this.$el=this.el instanceof e?this.el:e(this.el),this.el=this.$el[0],this.data=this.$el.data()}});var a=function(t,n){var r=this,i;t&&t.hasOwnProperty("constructor")?i=t.constructor:i=function(){r.apply(this,arguments)},e.extend(i,r,n);var s=function(){this.constructor=i};return s.prototype=r.prototype,i.prototype=new s,t&&e.extend(i.prototype,t),i.__super__=r.prototype,i};u.extend=o.extend=a})(jQuery);